id: SWAGGER_FILE_FOUND
info:
  name: Swagger file found
  description: ""
  details: >
            ""
  impact: ""
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: SWAGGER_FILE_FOUND
  severity: MEDIUM
  tags: 
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - ""

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

wordLists:
  locations: 
    - /swagger-ui/swagger-ui.js
    - /swagger/swagger-ui.js
    - /swagger-ui.js
    - /swagger/ui/swagger-ui.js
    - /swagger/index.html
    - /swagger/v1/swagger.json
    - /swagger-ui.html
    - /swagger-resources
    - /swagger/static/index.html
    - /swagger-ui/swagger.json
    - /swagger/ui/index
    - /apidocs/swagger.json
    - /api-docs/swagger.json
    - /swagger-ui/
    - /api-docs
    - /apidocs
    - /swagger
    - /v1/swagger.json
    - /api/apidocs
    - /api/v1/apidocs
    - /api/v2/apidocs
    - /api/api-docs
    - /api/v1/api-docs
    - /api/v2/api-docs
    - /swagger
    - /swagger/
    - /swagger.json
    - /swagger-ui.html
    - /swagger-ui.json
    - /swagger.yml
    - /api/swagger
    - /api/swagger/
    - /api/swagger.json
    - /api/swagger-ui/
    - /api/swagger-ui.html
    - /api/swagger-ui.json
    - /api/v1/swagger
    - /api/v1/swagger/
    - /api/v1/swagger.json
    - /api/v1/swagger-ui/
    - /api/v1/swagger-ui.html
    - /api/v1/swagger-ui.json
    - /api/v2/swagger
    - /api/v2/swagger/
    - /api/v2/swagger.json
    - /api/v2/swagger-ui/
    - /api/v2/swagger-ui.html
    - /api/v2/swagger-ui.json
    - /graphql
    - /api
    - /api/v1/
    - /api/v2
    - /api/v3

execute:
  type: single
  requests:
    - req:
      - modify_url: ${urlVar}/
      - modify_url:
          regex_replace:
            regex: \/+$
            replace_with: ${locations}

validate:
  response_code:
    gte: 200
    lt: 300

  response_payload:
    contains_either:
      - '"swagger":'
      - '"openapi":'
      - Swagger UI